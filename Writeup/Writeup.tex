\documentclass[11pt]{article}
\usepackage[left=3cm, right=3cm, top=2cm, bottom=2cm]{geometry}

\usepackage{verbatim}
\usepackage{afterpage}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{lineno}
\usepackage{setspace}
\usepackage{float}
\usepackage[comma]{natbib}
\usepackage{helvet}
\usepackage{wrapfig}
\usepackage{hyperref}
\usepackage{enumitem,kantlipsum}
%\documentclass{book}
\usepackage[labelfont=bf]{caption}
\DeclareCaptionFont{10pt}{\fontsize{10pt}{10pt}\selectfont}
\captionsetup{font={small,stretch=1.2}}
%,font=onehalfspacing


\graphicspath{{../Plots/}}

%% Remove hyphens
\tolerance=1
\emergencystretch=\maxdimen
\hyphenpenalty=10000
\hbadness=10000

\renewcommand{\familydefault}{\sfdefault}

\graphicspath{{../Results/}}

%\newcommand{\quickwordcount}[1]{%
%  \immediate\write18{texcount -1 -sum -merge -q #1.tex output.bbl > #1-words.sum }%
%  \input{#1-words.sum}%
%}
\newcommand{\reporttitle}{Artificial neural networks to predict foraging behaviour: salt-water immersion data can accurately predict diving in seabirds.}
\newcommand{\reportauthor}{Luke Swaby}
\newcommand{\reportcid}{01980806}
%\newcommand{\words}{\quickwordcount{main}}
\newcommand{\words}{5000}
\newcommand{\degreetype}{Master of Science}

\begin{document}
	\bibliographystyle{agsm}
	\setcitestyle{authoryear,open={(},close={)}}

    \onehalfspacing
    \input{Frontpage} % front page
    
    \section*{Declaration}
    The data reviewed in this project was collected Robin Freeman (ZSL), who then extracted it using the XManager software (\url{www.technosmart.eu}) and handed it over to me. I conducted all data processing and cleaning, as well as subsequent model building, training, and evaluation, but Robin closely advised and supervised the implementation of methods throughout.
    \newpage
    
    \linenumbers
    
    \renewcommand{\abstractname}{Abstract}
    \begin{abstract}
    
     The identification of key foraging locations is imperative for the conservation of biodiversity. For elusive and wide-ranging species, this process often depends on the deployment of cumbersome, power-hungry biologging devices that can significantly alter the behaviour of the animals wearing them, placing time constraints on studies that use them and casting doubt on the validity of the data they produce. Using an artificial neural network, I here evaluate the performance of salt-water immersion data derived from 3g light-level geolocators (GLS) as predictors of foraging behaviour in a species of pelagic seabird, using fine-scale tri-axial acceleration data as a performance benchmark. I test multiple time window widths for each predictor, and cross-validate predictions with data from withheld birds to ensure robust classification assessment. A probabilistic method of georeferencing results is then introduced in order to investigate the challenges of mapping predictions along flight paths in practise. When evaluated on reduced, balanced data sets, optimal models classified the behavioural states (dive/non-dive) of windows of data points with 98.5\% and 93.67\% accuracy for acceleration and immersion data respectively. For acceleration data, a window width of 4s was determined to be the optimum. For the comparatively low-resolution immersion data, this value was significantly larger, at 5mins. The results described in this project provide good reason to believe that GLS data can be used to identify diving events, and, by proxy, foraging locations, for wide-ranging seabird species throughout their annual cycles, and at a much lower cost both to researchers and to the animals wearing the devices than is currently accepted with the conventional method.
    \end{abstract}
    
    %%%%%%%%%%%%%%%% INTRODUCTION %%%%%%%%%%%%%%%%
    
    \section{Introduction}
    
    Identifying and protecting foraging locations is a key step in the conservation of biodiversity. In the marine environment, the foraging behaviours of many top predators are dependent on the distribution and predictability of resources across large spatial scales, and are accordingly considered to encode valuable information about the health of ecosystems globally. Pelagic seabirds in particular are often proposed as indicators of ecological status, and have been used extensively to inform ecosystem management and conservation strategies \citep{thaxter2012seabird,einoder2009review,mallory2010seabirds,paleczny2015population}. However, with direct observation largely precluded by their elusive and wide-ranging nature, fine-scale behavioural data on these species have only become available in recent years, where developments in telemetry and bio-logging technology have freed researchers from the epistemic constraints of sparse presence/absence data generated by traditional surveys at sea and ringing recoveries and truly pulled back the curtain on their lives over the open ocean \citep{rutz2009new,guilford2009migration,maclean2013evaluating,bograd2010biologging}. Perhaps most notably, the advent and continually declining size and cost of global positioning systems (GPS) and time-depth recorders (TDR) has enabled the collection of a wealth of high-resolution movement data that has been especially valuable in identifying the diving behaviours associated with seabird foraging \citep{guilford2008gps,thaxter2012seabird}. In studies investigating such behaviours to date, the method predominantly employed has been to use a combination of the two, mapping continuous dive profiles recorded by the latter to specific GPS coordinates recorded by the former by their respective timestamps to pinpoint dive events that can be used as proxies for foraging locations \citep{wanless1997use,shoji2015foraging,dean2013behavioural}. However, this technique has several limitations. 
    
    Firstly, despite the continuing miniaturization of logging devices, it has been demonstrated that even the lighter modern devices can significantly alter the behaviour of animals wearing them, casting doubt on the validity of the data they produce \citep{barron2010meta,calvo1992review,jackson2002potential}. For example, \cite{gillies2020short} found that Manx shearwaters (\emph{Puffinus puffinus}) fitted with 17g GPS loggers (4.2\% of bird body mass) more than doubled the length of their foraging trips and almost quartered the mass gained from those same trips as compared to birds carrying no devices or just small 2.5g leg-mounted geolocators. Considering that even compact, integrated, multi-sensor devices often still weigh over 15g, such findings strongly suggest that substantial weight reductions will still be needed before the data yielded by these devices can be interpreted as reflecting ‘natural behaviour’ with any confidence, especially when affixed to smaller animals or where multiple devices are used in unison. \
    
    Second, the comparatively steep costs of TDR devices and power consumption of high-resolution GPS loggers (often limiting battery life to just a few months) place significant financial and temporal constraints on studies wishing to combine the two, with the latter introducing the possibility of generating large quantities of surplus data whenever devices with differing battery lives are activated or deactivated asynchronously. As a consequence, there currently exists an archive of data that remain unexamined and, \emph{ipso facto}, untapped for potentially significant ecological insights. 
    
    While it is true that vast quantities of data can be produced during the overlapping period nonetheless, this itself poses the additional challenge of how to then analyse them \citep{urbano2010wildlife}. As reductions in technology costs have allowed a growing number of animals to be tagged with devices capable of sampling at ever-higher frequency, the complexity and volume of the resulting data sets has increased exponentially, driving up the sophistication of the tools required to analyse them also \citep{urbano2010wildlife,rutz2009new,kie2010home,smouse2010stochastic}. In behavioural studies, unsupervised approaches such as state-space models (e.g. hidden Markov Models) and Gaussian mixture models have become a popular choice for the task \citep{rutz2009new,dean2013behavioural,jonsen2005robust,patterson2009classifying,breed2012state}, and, in more recent years, many have assembled labelled data sets to leverage the abilities of more data-intensive, supervised machine learning (ML) techniques that can achieve similar predictive feats with even greater accuracy \citep{guilford2009migration,nathan2012using,martiskainen2009cow,grunewalder2012movement,carroll2014supervised}. However, many of these techniques demand much from the user, often requiring, for example, the manual extraction of \emph{features} (reduced summary statistics to simplify learning) from the raw data; an often laborious procedure that requires specialised knowledge and can drastically ramp up the complexity of implementing such models.
    
    Artificial Neural Networks (ANNs) are a family of powerful, general-purpose ML models that not only excel in handling big data, but also automate the process of feature extraction, thereby enabling fine-grained analysis of raw input data without demanding any domain-specific expertise of the user \citep{bishop1995neural}. By iteratively propagating data across multiple processing layers and using the resulting predictions to calculate the gradient of the network's error with respect to each of its individual parameters and adjust them accordingly (an algorithm known as 'backpropagation'), these models are capable of learning highly intricate properties of input data with many levels of abstraction. They have accordingly gained a lot of traction in the era of big data, where explosions in computational capacity and intractable data sets have highlighted their advantages over other more conventional ML methods (see \cite{lecun2015deep} for a review). However, despite driving breakthroughs in (and in many cases revolutionising) a broad range of topics from speech recognition and natural language processing \citep{collobert2011natural,sutskever2014sequence,mikolov2011strategies,wu2016google} to the more proximate fields of computer vision \citep{krizhevsky2012imagenet,girshick2014rich,farabet2012learning,tompson2014joint}, connectomics \citep{helmstaedter2013connectomic,turaga2010convolutional} and genomics \citep{eraslan2019deep,zou2019primer}, they have scarcely been used in the context of animal behavioural studies to date, having often been overlooked in favour of the more traditional aforementioned behavioural prediction techniques. But while this is sensible in cases where one wishes to understand the behavioural patterns distinctive of each class in a predictive problem, in the other case where one is concerned only with generating quick and accurate predictions, and not the mechanistic processes by which they are made, ANNs represent a powerful yet user-friendly tool for the job.
    
    Reinforcing this sentiment, a recent study demonstrated that ANNs could be used to predict the diving behaviour of three pelagic seabird species (\emph{Gulosus aristotelis}, \emph{Uria aalge} and \emph{Alca torda}) from GPS data \emph{alone} with greater accuracy than both hidden Markov models and a naive Bayes classifier \citep{browning2018predicting}. These findings not only attest to the untapped potential of ANNs as behavioural classification tools, but also importantly 
    show how seabird foraging can be successfully monitored without the need for costly TDR devices. However, while this is certainly a step in the right direction, the constraints of short battery life and behaviour impairment resulting from cumbersome device weight remain limiting for those who wish to employ a GPS-only methodology. As such, there is still a strong incentive to investigate whether similar insights can be derived from a less obstructive and longer-lasting bio-logging technology.
    
    Light level geolocators (GLS) are remarkably lightweight tracking devices (0.3g+), equipped with wet/dry sensors as well as ambient light sensors to determine location, that are often used to map bird migration routes \citep{newton2010migration,aakesson2012migration,minton2010initial,bachler2010year,jahn2013long}. 
    The data they produce are only rudimentary in comparison to GPS data, but what is lost in temporal and geographic resolution is compensated by the longevity of their battery lives, which can last for years on a single charge.
    There are accordingly substantial archives of GLS data available for birds for whom no other data is available. This wide availability of data in combination with the device's ultra-light weight and long battery life makes the light-level geolocator an ideal candidate for studies aiming to identify remote foraging locations for wide-ranging pelagics, for if it were possible to infer such information from GLS data alone, then researchers could collect and analyse substantially more data covering wider areas and from a broader range of species at a lower cost to both themselves and the animals wearing the devices, as well as map successful model predictions to the numerous animals for which only GLS data is available. 
    
    To this end, I here train an artificial neural network on a data set labelled with depth-validated diving events to evaluate the utility of salt-water immersion (IMM) data as a predictor of diving behaviour in pelagic seabirds, thereby providing the first known assessment of the potential for using GLS to identify foraging locations for wide-ranging species throughout their annual cycles. In order to establish a benchmark against which IMM performance may be judged, I also assess the predictive power of high-resolution, tri-axial acceleration data (ACC) for the same task. For both predictors I address the question of how the width of the time window of data to be classified affects model performance. These methods are used here to investigate the foraging behaviour of the Red-Footed Booby — a small, pantropical, diurnal, central-place foraging seabird widely understood to be the most pelagic of its genus \citep{nelson1978sulidae,schreiber1996red} — in the Chagos MPA, Indian Ocean. It is initially hypothesized that the comparatively low-resolution IMM data will struggle to identify localised dive events but succeed in roughly capturing the broader areas in which they occur due to the species-specific changes in the birds' interactions with the water during active foraging bouts. Much stronger performances are expected in the case of ACC data, and it is predicted that these results will serve to inform long-term telemetric deployments in the future. It is also expected that smaller window widths will achieve greater classification accuracy scores for ACC data, owing to its finer scale, and that the reverse will be true for IMM data.
    
    %%%%%%%%%%%%%%%% METHODS %%%%%%%%%%%%%%%%
    
    \section{Methods and Materials}

    \subsection{Data}
    The Exclusive Economic Zone of Chagos (EEZ) is a contiguous, no-take marine reserve established by the British government that contains within it a Ramsar site and several Important Bird Areas (IBA), making it a safe haven for the 18 species of breeding seabird to which it is home. The protected status of this area, along with the centralised foraging strategy employed by its resident RFBs, makes these birds ideal candidates for behavioural studies that require the deployment and eventual recovery of multiple logging devices, as it permits the observation of natural behaviour over the open ocean while remaining close enough to facilitate easy monitoring and access \citep{einoder2009review}.
    
    The data reviewed here were collected from 15 breeding RFBs tracked in the EEZ over a 3-6 day period in February 2019. All individuals were caught on Diego Garcia, the largest island of the Chagos Archipelago (7°18'48.0"S, 72°24'40.0"E), and fitted with a high-sampling-rate multi-sensor GPS logger (AxyTrek Marine, Technosmart, 14g) and a light-level geolocator/salt-water immersion logger (Intigeo C330, Migrate Technology, 3g). GPS loggers were configured to record geographical location every 30s, pressure every 1s, and tri-axial acceleration (ACC) at 25Hz. Geolocators, on the other hand, sampled at a much lower resolution, recording a binary immersion value (wet/dry) every 6s and the duration of time spent in each sequential state, as well as the light level at each minute, recording only the maximum value sampled in every 5 minute window. Figure 1 illustrates an example of how these data are distributed over the study period for a single bird. Of the 15 sets deployed, failure to recover hardware or subsequent data corruption meant that data could only be successfully extracted from 9 GPS and 6 GLS loggers, resulting in the availability of full data for 5 birds.
    
    \begin{figure}[t!]
	    \centering\includegraphics[width=1\textwidth]{../Plots/GLS_EXAMPLE_PLOT.pdf}
	    \caption{Example distribution of \textbf{a)} light level data; \textbf{b)} salt-water immersion data; and \textbf{c)} depth data for a single bird (\emph{ch\_gps16\_S1}) over the period it was tracked. Dark (night-time) periods are shown shaded grey. The plot shows how the bird interacts with the water exclusively during daylight hours and spends the whole of Feb 05 off the water, likely staying in a relatively shaded area around the colony. Diving events correlate strongly with periods immersed.}
    \end{figure}
    
    \subsection{Data Preprocessing}
    All preprocessing was carried out using the programming languages R (v4.1.0) and Python (v3.9.6). Firstly, raw pressure readings from the GPS logger were converted to depth data using the XManager software (\url{www.technosmart.eu}), and subsequently ‘de-noised’ to control for device idiosyncrasies. This was achieved by offsetting all values within a rolling window of ~30 records by the median of that window, effectively smoothing the low-level background fluctuations in each time-series whilst preserving the shape and location of each spike, thus enabling the determination of a fixed threshold for identifying dive events. For each bird, all data preceding the first aerial departure and following the final return to the island were clipped to ensure that none of the data reviewed here were influenced by device attachment/detachment processes (as multiple devices were logging data before and after their time fixed to a bird). GPS coordinates were also linearly interpolated in gaps exceeding 60s (i.e. where 1 or more readings had been missed). GLS files were then extracted and expanded to 6s resolution before being matched by ID to their corresponding GPS files (dropping excess data according to the same time frames) in order to append the transformed depth data within the latter to enable the identification of dive events. All in all, this resulted in a preliminary data set comprising 87,787,041 observations across 9 birds for ACC and 1,289,003 across 5 birds for GLS. To visualise these data, I mapped GPS tracks for all 9 birds over the MPA and calculated for each bird the total time tracked, total distance travelled (km), furthest distance travelled from the nest (assumed to be the mode lat/lon coordinates), maximum depth, and the total number of observed dive and non-dive events (method for determining these described below).
    
    
    \begin{figure}
	    \centering\includegraphics[width=1\textwidth]{../Plots/GPS_X_SUMSTATS.pdf}
	    \caption{Flight paths for all 9 GPS-tagged birds in the Exclusive Economic Zone of Chagos (outlined). Summary statistics for each bird are also shown, with birds from whom GLS data were also successfully recovered highlighted in blue. (One outlier was removed where the TDR fixed to bird \emph{ch\_gps03\_S1} recorded a depth value of over 10m.)}
    \end{figure}
    
    
    From the processed data, several labelled data sets were then constructed for each predictor using a rolling window of raw data points as inputs and binary values indicating whether a dive had occurred within each given window as the corresponding classes. Dives were classified in windows where at least 1 depth value exceeded a predetermined threshold of 0.1m, which was chosen through visual inspection of depth time-series plots to distinguish periods of residual background noise from the periods of sharp fluctuation that are characteristic of genuine diving events. A range of window widths were tested for each predictor to determine the optimum. These were chosen to span time intervals that could reasonably be expected to capture dive behaviour based on the resolution and distribution of the predictor (2s, 4s, 6s, 8s, \& 10s for ACC, and 1min, 3min, 5min, 7min, and 9min for IMM). To investigate the effects of diluting the ACC data on its predictive power, an additional data set was created using as inputs only the mean and sum of absolute differences of 4min windows of data points along the z-axis. (However, time constraints meant that this part of the analysis could not be seen through to completion. Results reported here are accordingly only preliminary, and shouldn't be considered conclusive.)
    
    The method described above produced a number of large data sets that were highly imbalanced (1TB+ files for larger window widths, in which only $\sim$0.18\% of rows contained dive behaviour), so to sidestep consequent performance and memory-related issues, a smaller, more balanced subset was extracted from each set by randomly undersampling the majority class (i.e. non-dives) to roughly match the number of dive rows, reducing the maximum file size to $\sim$2GB. 
    

    \subsection{Model Fitting}
    Artificial neural networks were used to predict behavioural states. Model fitting was performed primarily in Keras (v2.5.0) — an elegant, high-level API for interfacing with Google's Tensorflow library to build, train, and evaluate neural networks — using a basic architecture of 2 hidden layers of 200 rectifier nodes (each with a dropout rate of 0.2) followed by a softmax binary output layer. The shape of the input layer varied with the window width and number/resolution of variables used to generate the input data. IMM constitutes a single variable and is therefore associated with just one sequence of values, whereas the same is true for each of the 3 axes of the ACC data. Therefore, the size of the input layer ranged from 10 nodes where a window width of 60s was used for 1/6Hz GLS data to 750 where a width of 10s was used for the 25Hz tri-axial ACC data. To diagnose the performance of the IMM classifier, a separate classifier was also constructed to simply predict dive events wherever a window contains a mix of wet and dry samples and a non-dive event wherever all samples in the window are homogenous (i.e. all dry or all wet). This naive model was tested on the same, reduced data as the neural network for performance comparison.
    
    At first, \emph{k}-fold cross-validation was attempted in order to get a robust estimate of the model’s skill at predicting dive events. However, the autocorrelation between rows in the input rolling-window data meant that using random sampling to split them would likely mean testing models with samples virtually identical to ones already seen during training, misleadingly driving up resulting accuracy scores. Seeing as a key aim here is to generalise results to unseen birds, I instead adopted a customised ‘leave-one-out’ cross-validation method whereby data was split by bird ID so that each model in the cross-validation procedure could be tested against one withheld bird and trained on the rest, better reflecting how such models would be used in practise. All models were saved for downstream analysis, resulting in a single saved model for each bird for each window width.
    
    \begin{figure}[t!]
	    \centering\includegraphics[width=1\textwidth]{../Plots/ALL_METRICS_TABLE.pdf}
	    \caption{Table of cross-validated, mean classification metrics for each window width tested for each predictor. Using accuracy as a guide, optimal predictions were produced when a 4s window width was used for ACC data and a 5min window width was used for IMM data.}
    \end{figure}
    
    The classification accuracy, Area Under the ROC Curve (AUC), precision, sensitivity, and specificity were calculated for all models, as well as the scaled confusion matrix. These metrics were then averaged to produce single, cross-validated scores for each window width (Fig. 3), which were used to determine the optimal for each predictor. 
    
    \subsection{Georeferencing Predictions}
    
    The predictions of the best models were georeferenced to gain a deeper understanding of how these can be used to pinpoint foraging locations in practise. To this end, the timestamp at the midpoint of each feature window was saved along with its corresponding class during the construction of the rolling window data so that they could be mapped to their nearest GPS coordinates. GPS data was left raw for mapping ACC predictions, but for the IMM predictions, to account for the relatively large window widths used to compensate for the data's low temporal resolution, GPS data was first collapsed to 5min resolution to ensure that the window surrounding each GPS coordinate contained within it the largest part of several IMM windows rather than just a small proportion of a handful. (Keeping GPS data at 30s resolution would mean having the midpoint of 6 IMM windows falling within 15s of — and consequently being mapped to — each GPS coordinate, despite the fact that each of these windows may cover up to 18 other GPS coordinates also!) This way, the status of a GPS location could be ascertained by examining the proportion of dive predictions in its immediate vicinity. If this proportion fell above a certain threshold, then the GPS coordinate at the centre of said window would qualify as a dive location. This method of georeferencing was applied for both predictors, with the threshold set to a default value of 50\% in each case (the effect of changing this value is not examined here, but could be subject to further investigation - see Discussion). 
    
    %%%%%%%%%%%%%%%% RESULTS %%%%%%%%%%%%%%%%
    
    \begin{figure}[b!]
	    \centering\includegraphics[width=1\textwidth]{../Plots/BOXPLOT.pdf}
	    \caption{Box plots showing the distribution of classification metrics scored by optimal models for both predictors across folds of the leave-one-out cross-validation process. Therefore, each point corresponds to a bird withheld for model testing. Outliers are labelled with tag ID.}
    \end{figure}
    
    \section{Results}
    Figure 2 shows the mapped GPS tracks for all 9 birds as well as accompanying summary statistics. Classification metrics for all predictive models are summarised in Figure 3. 
    
    \subsection{ACC data}
    Using raw, tri-axial ACC data to predict dive events, it was found that all leave-one-out cross-validated models scored mean accuracy values of above 97\%, demonstrating strong predictive power for this data that is robust to a withheld bird. Additionally, sensitivity and specificity remained high across all window widths tested, indicating a general proficiency at detecting both dive events and non-dive events.
    The optimal model was produced where a 4s time window was used to generate training data (see Fig. 5 for the resulting confusion matrix), scoring a mean accuracy of 98.5\% that varied negligibly between birds withheld in each fold of the cross-validation procedure (Fig. 4). Mean sensitivity and precision scores for this model were each second highest of those tested, representing the best combination at minimising the number of genuine dive sites missed (false negatives) while preventing overclassification by penalising bogus dive sites (false positives).
    
    Models trained only with z-axis ACC summary statistics performed substantially worse, scoring a mean classification accuracy of 87.15\% (sensitivity=95.6\%, specificity=78.7\%), indicating that diluting the data in this way preserves some measure of what constitutes a dive but also drives the misclassification of non-dive events.
    
    \subsection{IMM data}
    The results of models using IMM data to predict dive events showed increased variation and slightly reduced accuracy, ranging from 81.41\% to 93.67\% where window widths of 1min and 5min were used respectively (Fig. 3). Precision saw the most significant reductions of all metrics compared to ACC data, dropping by a mean average of nearly 8\% (Fig. 4). While sensitivity scaled roughly in proportion to window width, a negative correlation was observed between window width and precision (and also window width and specificity), suggesting that larger window widths capture higher proportions of genuine dive events but also drive the misclassification of non-dive events for this predictor. The optimal window width was accordingly the median of those tested. When cross-validating the predictions of this model, the model evaluated using data from bird \emph{ch\_gps12\_S1} scored significantly lower precision (85.92\%) than the others (91.42\%+), suggesting that this bird often exhibited ‘dive-looking’ behaviour while not actually foraging (Fig. 4).
    
    Interestingly, the naive immersion classifier correctly classified 92.77\% of the same data. Sensitivity remained high for this model at 97.62\%, meaning that diving events were generally identified correctly on the whole, whereas specificity and precision fell to 88.13\% and 88.71\% respectively, indicating that the aforementioned increase in sensitivity is likely due to an overclassification of diving events and that the marginal performance gap between the naive classifier and the ANN is due to the latter's superior ability to discriminate windows containing a mixture of wet and dry samples.
    
    \subsection{Georeferencing}
    When mapped to nearest GPS coordinates, the distribution of dive and non-dive predictions returned to an imbalance comparable to that of the dive data prior to subsetting (Fig. 6). This is due to the fact that the majority of dive samples produced in the rolling window data subsets were generated around single, highly localised events, meaning that any positive predictions corresponding to these samples collapsed back into a small handful of points when georeferenced. Both predictors remained highly proficient at detecting genuine dive sites (sensitivity=96.43\% for ACC, sensitivity=96.55\% for IMM). Naturally, however, the relative occurrence rate of true negatives and false positives rose sharply. As a consequence, the negative predictive value of this georeferencing method was near-perfect (99.96\% for ACC, 99.81\% for IMM), while the precision was significantly lower (56.25\% for ACC, 51.85\% for IMM). In short, this means that this method is excellent at identifying non-dive events, misclassifying only an tiny proportion of them for both predictors, but the abundance of non-dive samples makes these proportions amount to substantially large quantities compared to the relatively rare incidence of dives. 
    
    This being said, it can be seen in Figure 6 that the vast majority of false positives for both predictors were clustered tightly around true positives, with the few that did not follow this pattern occurring much more sporadically. Accordingly, if the aim is to roughly identify regions in which foraging behaviours occur, then it seems as though the occurrence of false positives when implementing this method is mostly benign, and it is likely that so long as a suitable threshold is chosen to distinguish clusters of positive predictions from solitary ones then then the erroneous highlighting of unimportant areas can be minimised. 

    
     \begin{figure}[t!]
	    \centering\includegraphics[width=1\textwidth]{../Plots/CM.pdf}
	    \caption{Scaled confusion matrices for the optimal models of both \textbf{a)} ACC; and \textbf{b)} IMM data, showing the proportion of total data points in each classification bin.}
    \end{figure}
    
    %%%%%%%%%%%%%%%% DISCUSSION %%%%%%%%%%%%%%%%
    
    \section{Discussion}
    Using the combined data from GLS and integrated GPS/TDR devices, I trained an artificial neural network to compare the performances of 25Hz tri-axial acceleration data (ACC) and 1/6Hz salt-water immersion data (IMM) as predictors of diving behaviour of Red Footed Boobies. Predictions were validated with diving events identified using depth data. It was found that ANNs can predict the behavioural status (dive/non-dive) of a 4s window of 25Hz ACC data with 98.5\% accuracy and the status of a 5min window of 1/6Hz IMM data with 93.67\% accuracy, and that IMM data could correctly classify similar proportions of genuine diving events to ACC data but significantly less non-diving events. 
    
    From these findings it seems plausible that diving behaviours, and, by proxy, foraging locations, can be mapped for wide-ranging animals throughout their annual cycles while keeping device weight (and its consequent behavioural confounds) to a minimum; a promising result in a field where such insights have hitherto been available only over short time-frames (and for larger birds). There are, however, some noteworthy caveats to doing this in practise.
    
    Firstly, it is important to note that all models tested here were trained on reduced data sets, and as such did not see the vast majority of data pertaining to each bird. When applied to a full data set for georeferencing, it is likely that the enormous increase in negative (i.e non-dive) samples to be classified would drastically ramp up the incidence of false positives. Judging by the GPS track produced from the reduced data set (Fig. 6b), it seems as though these generally cluster around true positives — which become very localised when collapsed into their nearest GPS coordinates due to the autocorrelation between samples — and are much more sporadic elsewhere, suggesting that the determination of a robust method for distinguishing the two (e.g. a minimum proportion of positive predictions in the window surrounding each GPS coordinate that must be satisfied if it is to be classified as a dive location) could help refine model precision further. 
    
    \begin{figure}
	    \centering\includegraphics[scale=0.78]{../Plots/CM_PRED_TRACK_ch_gps07_S1.pdf}
	    \caption{Example of georeferenced model predictions for reduced data sets containing \textbf{a)} 4s windows of ACC data; and \textbf{b)} 5min windows of IMM data for bird \emph{ch\_gps07\_S1}. True negatives are included in the legend but omitted from the track for visual clarity. Points are partially transparent, meaning that darker hues indicate clusters of overlapping points in the same region. Mismatch of total no. of predictions between the two maps is due to the differing resolutions of the GPS data and the predictor itself. Tracks show an increase in the proportion of false positives compared to the distribution of errors in the predictions prior to mapping, yet these are largely clustered around true positives and sparse elsewhere.}
    \end{figure}
    
    Additionally, it should be noted that the data sets were reduced in the first place to rectify the considerable class imbalance by undersampling the majority class (non-dives), but there are various techniques for doing the reverse and oversampling the minority class if performance requires it. For example, one method (dubbed ‘SMOTE’ by its inventors: \cite{chawla2002smote}) involves generating synthetic samples using a k-nearest neighbours approach to augment the minority class and balance the class distribution, thereby enabling the model to see all available data and still learn the decision boundary effectively. As all models evaluated in this project were only exposed to a tiny minority of the available ‘non-dive’ data during training, it is possible that important insights as to what constitutes a ‘non-dive’ sample were missed, and accordingly that model precision (and, indeed, overall performance) could have been further improved by adopting such a method as SMOTE for balancing the class distribution before training.
    
    Another important consideration is the way the depth threshold used to identify dive events was established for each bird when labelling the training data. Here, once the depth distributions had been ‘de-noised’,  a fixed threshold of 0.1m was determined by eye that subsequently applied for all birds. But while it is true that this threshold seems to have successfully distinguished diving behaviour for the most part, it is also possible that idiosyncrasies in both individual bird behaviour and device sampling could make a single threshold inappropriate for multiple birds. 
    For studies wishing to replicate the methods described here, a more statistically rigorous method of establishing this value, or multiple values for multiple birds (e.g. using change-point analysis), would likely improve the labelling accuracy of the data and consequently reduce the errors made by models trained with it.
    
    The particular foraging behaviours of the bird species under review have important implications for data labelling also. Red-footed boobies are shallow-diving seabirds that engage in a variety of diving behaviours when foraging, including surface dives, plunge dives from low altitudes, and, less frequently, aerial dives to catch aerially locomotive prey such as flying fish or squid above the surface \citep{weimerskirch2005three,diamond1974red,pitman1993booby}. The mix of shallow diving behaviours and near-surface non-foraging activity complicates inferring any distinctions from depth data alone, as, for example, the depth value separating a foraging surface dive from a period merely sitting on the surface with legs submerged may be obscure. (In the case of IMM data for RFBs in particular, aerial foraging events will be missed altogether!) For species whose interactions with the water during foraging are more distinctive, such as deep-divers or those who engage in an active swim phase (e.g. Gannets), determining labels in the training data should be less problematic, leading to all-round better model performance. 
    
    \subsection{ACC to predict foraging behaviour}
    Irrespective of future use of IMM data for the means described here, it can be safely concluded from my results that ACC data is an excellent predictor of diving behaviour in pelagic seabirds. While it is true that this revelation will not be so useful to those wishing to map foraging locations for birds for whom GLS data has already been collected, it certainly attests to the potential merits of using accelerometers alongside GLS in future studies aiming to do something similar. For this to be feasible, an accelerometer would need to weigh no more than a few grams and have a long operational life (preferably over a year), yet store enough data at a high enough resolution to capture the information required to identify fleeting behaviours that occur infrequently.
    As acknowledged by \cite{backman2017actogram} in their review of the usage of accelerometers in migration studies, the development of a device that meets all these requirements is a challenge, but has been successfully achieved in a number of studies. \cite{liechti2013first}, for example, used a 1.5g data logger configured to record light intensity and dynamic acceleration every 4mins by sampling 32 measurements of acceleration along the z-axis at 10Hz — recording only the mean of each sample and sum of the absolute differences between each consecutive data point in each sample on account of storage limitations — that lasted year-round, and \cite{hedenstrom2016annual} used a similar approach to record acceleration and light level data over a full 2 year period.
    
    It remains unclear precisely what effect such resolution cutbacks would have on the performance of a model built to predict diving behaviour specifically using ACC data. The preliminary results of the models trained here with z-axis summary statistics suggest that predictive accuracy would suffer, but it is important to note firstly that these cutbacks are only required inasmuch as longevity is necessary to any given study, and secondly that, for those to which it \emph{is} necessary, it is highly possible that enough information can be captured by the right summary statistics (or perhaps their combination with some other predictor) to identify diving behavior nonetheless. Accordingly, while the advent of lightweight geolocators with inbuilt accelerometers leaves open the possibility that the predictive power of ACC data demonstrated here can still be leveraged in more longitudinal studies of wider-ranging birds, it cannot be commented on with any certainty until the performance tradeoffs of diluting ACC data in the ways mentioned above are investigated further.
    
    \subsection{IMM to predict diving behaviour}
    On the other hand, the results described in this project provide good reason to believe that diving behaviours, and, by proxy, foraging locations, are also predictable for animals for whom only GLS data are available. Accordingly, it seems plausible that the methods described here can be applied both in future studies assessing the long-term behavioural patterns of wide-ranging birds (using GLS either singularly or in combination with one or more other informative, long-term predictors, such as ACC) \emph{and} to the archive of GLS data already available from past projects. 

    \begin{figure}[t!]
	    \centering\includegraphics[scale=0.5]{../Plots/FACET_HISTOGRAM.pdf}
	    \caption{Facet-wrapped histogram showing the disribution of wet/dry samples across all 5min windows used in the reduced IMM dataset, and how they were classfied by: \textbf{a)} their corresponding depth-validated labels; \textbf{b)} the neural network; and \textbf{c)} the naive classifier. It is clear from the top two rows that both the ANN and naive model classify all homogeneous windows (i.e. all wet or all dry) as non-dives. The bottom row shows that the ANN better discriminates windows containing a mix of wet and dry samples.}
    \end{figure}
    
    %\begin{wrapfigure}{O}{0.65\textwidth}
    %  \begin{center}
    %    \includegraphics[width=0.63\textwidth]{../Plots/FACET_HISTOGRAM.pdf}
    %  \end{center}
    %  \caption{Birds}
    %\end{wrapfigure}

    The strong predictive accuracy achieved by the naive IMM classifier points to some interesting considerations regarding species-specific foraging behaviours and their implications for model classification heuristics. Relevant to this particular project, for instance, is the knowledge that RFBs land on the sea surface much more frequently than most other seabirds during active foraging bouts \citep{weimerskirch2005three}. It accordingly makes sense that the naive model should be accurate, as it could be speculated from this premise \emph{a priori} that most windows containing a mix of wet and dry samples will either contain, or fall close to, a genuine dive event; a hypothesis confirmed by subsequent analysis of the distribution of wet/dry samples across all predicted windows (Fig. 7). (It follows that the value of the ANN here lies in its ability to better discriminate the attributes of the mixed samples to facilitate their identification. However, the ‘black-box’ nature of the technique precludes further analysis of how this is achieved.) Similarly, it is not difficult to imagine that an analogous — and perhaps even more effective — heuristic for identifying dive events could exist for other species whose interactions with the water are almost exclusively linked to foraging, obviating the need for a sophisticated model altogether in cases where quick approximations are needed. 
    
    However, the converse is also true: immersion patterns of species with more complex interactions with the sea surface may be too difficult to accurately classify, even for an ANN, and while it is true that model performance could probably be improved with the inclusion of other GLS products such as LUX data (e.g. by assigning lower probabilities to 'foraging-like' behaviours observed at low light levels for diurnal species, thereby accounting for any temporal element of the animal's feeding cycle), this obstacle may prove insurmountable without finer-scale immersion data. Therefore, while the ability of immersion data to predict diving behaviour demonstrated here is no doubt promising, it cannot necessarily be generalised to other bird species without first taking such considerations into account.
    
    
    \newpage
    \nolinenumbers
    \section*{Data and Code Availability}
    
    \begin{itemize}
      \item  Data: ...
      \item Code: \url{https://github.com/ldswaby/seabirds/tree/master}
    \end{itemize}
    
    \noindent Please note that in order for the code to execute successfully the Data/ directory must be in the same directory as the Code/ directory. The required directory structure can be viewed in the README.md file in the github repository.

    \newpage
    
    %\bibliographystyle{abbrvnat}
    \bibliography{Biblio}
\end{document}